
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>



    @ViewData["hcdata"]

    <div id="container" style="min-width: 300px; height: 400px; margin: 0 auto"></div>

<script type="text/javascript" src="https://cdn.hcharts.cn/jquery/jquery-1.8.3.min.js"></script>
<script src="~/Scripts/Highcharts-5.0.10/code/highcharts.js"></script>
<script src="~/Scripts/Highcharts-5.0.10/code/modules/exporting.js"></script>

<script type="text/javascript">
    $(function () {
        setColumnCharts();
    });

    function setColumnCharts() {

        var dataUser = "@ViewData["hcdata"]";  
        var reg = new RegExp("&quot;", "g"); //创建正则RegExp对象
        var reg2 = new RegExp("&#39;", "g")
        var datauser2 = dataUser.replace(reg, '"');
        var datauser3 = datauser2.replace(reg2,'\'')
        var datahc = JSON.parse(datauser3);

        //alert(datahc);
        //$('#Container').highcharts({
        //    chart: {
        //        type: 'pie',
        //        plotBackgroundColor: null,
        //        plotBorderWidth: null,
        //        plotShadow: false
        //    },
        //    credits: {       //去掉官网链接
        //        text: ""
        //    },
        //    title: {
        //        text: '<span style="color:#000;font-weight:bold;">项目-按招标单位统计</span>'
        //    },
        //    plotOptions: {
        //        pie: {
        //            allowPointSelect: true,
        //            cursor: 'pointer',
        //            dataLabels: {
        //                enabled: true,
        //                color: '#000000',
        //                connectorColor: '#000000',
        //                format: '<b>{point.name}</b>: {point.percentage:.1f} %'
        //            }
        //        }
        //    },
        //    /* xAxis: {
        //         categories: categories
        //     },
        //     yAxis: {
        //         min: 0,
        //         title: {
        //             text: '项目数（个）'
        //         }
        //     },*/
        //    tooltip: {
        //        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        //    },
        //    series: [{
        //        name: name,
        //        data: datahc,
        //        color: 'blue'
        //    }]
        //});
        alert(datahc);
        Highcharts.chart('container', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: '任务类型统计'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                        style: {
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    }
                }
            },
            series: [{
                name: '占比',
                colorByPoint: true,
                data: datahc
                //data: [{
                //    name: 'Microsoft Internet Explorer',
                //    y: 56.33
                //}, {
                //    name: 'Chrome',
                //    y: 24.03
                //    //sliced: true,
                //    //selected: true
                //}, {
                //    name: 'Firefox',
                //    y: 10.38
                //}, {
                //    name: 'Safari',
                //    y: 4.77
                //}, {
                //    name: 'Opera',
                //    y: 0.91
                //}, {
                //    name: 'Proprietary or Undetectable',
                //    y: 0.2
                //}]
            }]
        });
    }
</script>