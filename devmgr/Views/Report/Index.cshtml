
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="navbar-collapse collapse">
    <ul class="nav navbar-nav">
        <li>@Html.ActionLink("任务管理", "Index", "FLOW_MISSION")</li>
        <li>@Html.ActionLink("任务统计", "Index", "Report")</li>
    </ul>
</div>
    <h2>任务统计</h2>


    

    <div id="container" style="min-width: 300px; height: 400px; margin: 0 auto"></div>

    <script type="text/javascript" src="https://cdn.hcharts.cn/jquery/jquery-1.8.3.min.js"></script>
    <script src="~/Scripts/Highcharts-5.0.10/code/highcharts.js"></script>
    <script src="~/Scripts/Highcharts-5.0.10/code/modules/exporting.js"></script>

    <script type="text/javascript">
        $(function () {
            setColumnCharts();
        });

        function setColumnCharts() {

            var dataUser = "@ViewData["hcdata"]";
            var reg = new RegExp("&quot;", "g"); //创建正则RegExp对象
            var reg2 = new RegExp("&#39;", "g")
            var datauser2 = dataUser.replace(reg, '"');
            var datauser3 = datauser2.replace(reg2, '\'')
            var datahc = JSON.parse(datauser3);

            Highcharts.chart('container', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: '任务类型统计'
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>:{point.y}个 {point.percentage:.1f} % ',
                            style: {
                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                            }
                        }
                    }
                },
                series: [{
                    name: '占比',
                    colorByPoint: true,
                    data: eval(datahc)
                }]
            });
        }
    </script>
